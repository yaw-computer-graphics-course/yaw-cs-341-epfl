<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Theory Exercise RT1 – Ray-Cylinder Intersection</title>
  <style>
    html {
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 12px;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      html {
        background-color: white;
      }
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    svg {
      height: auto;
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
      font-size: 85%;
      margin: 0;
      hyphens: manual;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      border: none;
      border-top: 1px solid #1a1a1a;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
  </style>
  <script
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
  type="text/javascript"></script>
</head>
<body>
<header id="title-block-header">
<h1 class="title">Theory Exercise RT1 – Ray-Cylinder Intersection</h1>
</header>
<h1 id="theory-exercise-homework-1-rt1">Theory Exercise Homework 1
(RT1)</h1>
<h2 id="ray-cylinder-intersection">Ray-Cylinder Intersection</h2>
<h2 id="notation-reminder">Notation Reminder</h2>
<ul>
<li><p><span class="math inline">\(\mathbf{o}\)</span> : Ray
origin</p></li>
<li><p><span class="math inline">\(\mathbf{d}\)</span> : Ray
direction</p></li>
<li><p><span class="math inline">\(\mathbf{c}\)</span> : Cylinder
center</p></li>
<li><p><span class="math inline">\(\mathbf{a}\)</span> : Cylinder
axis</p></li>
<li><p><span class="math inline">\(h\)</span> : Cylinder height</p></li>
<li><p><span class="math inline">\(r\)</span> : Cylinder radius</p></li>
</ul>
<figure>
<img src="images/cyl_diagram.png" width="300"
alt="A cylinder with axis \mathbf{a}, center \mathbf{c}, radius r, and height h" />
<figcaption aria-hidden="true">A cylinder with axis <span
class="math inline">\(\mathbf{a}\)</span>, center <span
class="math inline">\(\mathbf{c}\)</span>, radius <span
class="math inline">\(r\)</span>, and height <span
class="math inline">\(h\)</span></figcaption>
</figure>
<p></br></p>
<p>For the ray-cylinder intersection task, our approach is based on the
following steps:</p>
<ol type="1">
<li><p><strong>Identify the equations of the cylinder and ray
trajectory.</strong><br />
<br />
They are represented as follows: <span
class="math display">\[\text{Cylinder : } \frac{||\mathbf{a} \times
(\mathbf{{\color{red} x} - \mathbf{c}})||}{||\mathbf{a}||} = r
\hspace{1cm} ; \hspace{1cm} \text{Ray trajectory : }
\mathbf{{\color{red} x}} = \mathbf{o} + t\mathbf{d} \hspace{1cm} t \in
\mathbb{R}\]</span> <em>We assume here that our cylinder is of infinite
height, we’ll make sure to restrict the number of rays according to the
real height later.</em></p></li>
<li><p><strong>Compute the intersection points by combining the 2
equations.</strong><br />
<br />
We then get the following equation which we solve for t : <span
class="math display">\[\frac{||\mathbf{a} \times (\mathbf{o} +
{\color{blue} t}\mathbf{d} - \mathbf{c})||}{||\mathbf{a}||} = r
\Leftrightarrow ||\mathbf{a} \times (\mathbf{o} + {\color{blue}
t}\mathbf{d} - \mathbf{c})|| = r\]</span> <em>The axis vector given in
the ray_cylinder_intersection function is normalised so its norm is
equal to 1.</em><br />
<br />
We then simplify it to a second degree equation. For ease of
understanding, we define the following vectors :</p>
<ul>
<li><p><span class="math inline">\(\mathbf{oc} = \mathbf{o} -
\mathbf{c}\)</span></p></li>
<li><p><span class="math inline">\(\mathbf{m} = \mathbf{a} \times
\mathbf{oc}\)</span></p></li>
<li><p><span class="math inline">\(\mathbf{n} = \mathbf{a} \times
\mathbf{d}\)</span></p></li>
</ul>
<p>$<span class="math inline">\(\begin{aligned}
     ||\mathbf{a} \times (\mathbf{o} + {\color{blue} t}\mathbf{d} -
\mathbf{c})|| = r
        &amp;\Leftrightarrow ||\mathbf{a} \times (\mathbf{oc} +
{\color{blue} t}\mathbf{d})|| = r \\
        &amp;\Leftrightarrow ||\mathbf{a} \times \mathbf{oc} +
\mathbf{a} \times {\color{blue} t}\mathbf{d}|| = r \\
        &amp;\Leftrightarrow ||\mathbf{m} + {\color{blue} t}\mathbf{n}||
= r \\
        &amp;\Leftrightarrow ||\mathbf{m}||^2 + {\color{blue}
t}^2||\mathbf{n}||^2 + 2{\color{blue} t} (\mathbf{m} \cdot \mathbf{n}) =
r^2\\
        &amp;\Leftrightarrow {\color{blue} t}^2||\mathbf{n}||^2 +
2{\color{blue} t} (\mathbf{m} \cdot \mathbf{n}) + ||\mathbf{m}||^2 - r^2
= 0
\end{aligned}\)</span></p></li>
<li><p><strong>Choose the solutions</strong><br />
</p>
<ol type="1">
<li><p><strong>No intersections between the ray and the
cylinder</strong><br />
This is the case where there is no solution to the above equation or all
solutions are negative, so our function returns false.</p></li>
<li><p><strong>One or more intersections</strong> This is the case where
there is at least one positive solution (if there are 2, we take the
smallest one), let’s call it t. Given that we assumed in the beginning
that the cylinder is of infinite height, we know have restrict our
solution with the real height. For that we first compute the
intersection point given by : <span class="math display">\[\mathbf{i} =
\mathbf{o} + {\color{blue} t}\mathbf{d}\]</span> We use it then to get
the vector <span class="math inline">\(\mathbf{ci}\)</span> connecting
the center and intersection point: <span
class="math display">\[\mathbf{ci} = \mathbf{i} - \mathbf{c}\]</span>
And finally, we compute the norm of its projection on the cylinder axis:
<span class="math display">\[H = \left|\left| (\mathbf{ci} \cdot
\mathbf{a}) \mathbf{a} \right|\right| = \mathbf{ci} \cdot
\mathbf{a}\]</span> If <span class="math inline">\(H \leq
\frac{h}{2}\)</span> then <span class="math inline">\({\color{blue}
t}\)</span> is in fact a solution.</p></li>
</ol></li>
<li><p><strong>Get the normal to the cylinder</strong><br />
<br />
All that’s left do now is get the normal vector which is obtained by
taking <span class="math inline">\(\mathbf{ci}\)</span> and retracting
its projection on the cylinders axis: <span
class="math display">\[\mathbf{cn} = \mathbf{ci} - (\mathbf{ci} \cdot
\mathbf{a})\mathbf{a}\]</span> But here, the normal can be either <span
class="math inline">\(+ \mathbf{cn}\)</span> or <span
class="math inline">\(- \mathbf{cn}\)</span> depending of where the ray
might be coming from. The solution can be found using : <span
class="math display">\[\mathbf{normal} = sgn((\mathbf{o} - \mathbf{i})
\cdot \mathbf{cn})\text{ } \mathbf{cn}\]</span></p></li>
</ol>
</body>
</html>
